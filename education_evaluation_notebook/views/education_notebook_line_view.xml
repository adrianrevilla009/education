<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
	<!-- TREE VIEW -->
	<record id="education_notebook_line_view_tree"
		model="ir.ui.view">
		<field name="model">education.notebook.line</field>
		<field name="arch" type="xml">
			<tree string="Evaluation notebook" create="true" delete="true"
				decoration-info="comp_global_check==True"
				decoration-success="comp_eval_check==True">
				<field name="comp_eval_check" invisible="1" />
                <field name="comp_global_check" invisible="1" />
				<field name="competence_id" />
				<field name="description" />
				<field name="eval_percent" />
				<field name="father_competence_id" />
				<field name="father_father_competence_id" 
				attrs="{'invisible':['|',('comp_eval_check','=',True),('comp_global_check','=',True)],
                'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}"/>
                <field name="competence_type_id" />
				<field name="planification_id" />
				<field name="teacher_id" />
				<field name="a_year_id" />
				<field name="education_center_id" />
				<field name="classroom_id" />
				<field name="task_type_id" />
				<field name="eval_type" />
			</tree>
		</field>
	</record>
	<!-- SEARCH VIEW -->
	<record id="education_notebook_line_view_search"
		model="ir.ui.view">
		<field name="model">education.notebook.line</field>
		<field name="arch" type="xml">
			<search>
                <field name="comp_eval_check" invisible="1" />
                <field name="comp_global_check" invisible="1" />
			    <field name="competence_id" 
			    attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
			    <field name="description" 
			    attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
			    <field name="eval_percent"  />
			    <field name="father_competence_id" 
			    attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
			    <field name="father_father_competence_id" 
			    attrs="{'invisible':['|',('comp_eval_check','=',True),('comp_global_check','=',True)],
                 'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
                <field name="competence_type_id" 
                attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
				<field name="planification_id" 
				attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
				<field name="teacher_id" 
				attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
				<field name="a_year_id" 
				attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
				<field name="education_center_id" 
				attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
				<field name="classroom_id" 
				attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
				<field name="task_type_id" 
				attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
				<field name="eval_type" 
				attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
				<group expand="1" string="Group By">
					<filter name="groupby_evaluacion"
						context="{'group_by' : 'eval_type'}" string="Evaluation" />
					<filter name="groupby_competence"
						context="{'group_by' : 'competence_id'}" string="Competence" />
					<filter name="groupby_competencetype"
						context="{'group_by' : 'competence_type_id'}"
						string="Competence type" />
					<filter name="groupby_teacher"
						context="{'group_by' : 'teacher_id'}" string="Teacher" />
					<filter name="groupby_year"
						context="{'group_by' : 'a_year_id'}" string="Year" />
					<filter name="groupby_center"
						context="{'group_by' : 'education_center_id'}"
						string="Education center" />
					<filter name="groupby_classroom"
						context="{'group_by' : 'classroom_id'}" string="Classroom" />
					<filter name="groupby_fathercompetence"
						context="{'group_by' : 'father_competence_id'}"
						string="Father competence" />
					<filter name="groupby_fatherfathercompetence"
                        context="{'group_by' : 'father_father_competence_id'}"
                        string="Fathers father competence" /> 
				</group>
			</search>
		</field>
	</record>
	<!-- FORM VIEW -->
	<record id="education_notebook_line_view_form"
		model="ir.ui.view">
		<field name="model">education.notebook.line</field>
		<field name="arch" type="xml">
		<form string="Evaluation notebook">
		  <sheet>
			<div class="oe_button_box" name="button_box">
			    <button class="oe_stat_button" type="object"
                    name="button_show_all_exams_academic_records" icon="fa-th">
                    <field name="all_exams_academic_records_count" widget="statinfo"
                        string="Exam records" class="mr4" />
                </button>
                <button class="oe_stat_button" type="object"
                    name="button_show_evaluation_academic_records" icon="fa-th-list"
                    attrs="{'invisible': [('comp_global_check','=',False)]}">
                    <field name="evaluation_academic_records_count" widget="statinfo"
                        string="Eval records" class="mr4" />
                </button>
				<button class="oe_stat_button" type="object"
					name="button_show_line_academic_records" icon="fa-th-large">
					<field name="line_academic_records_count" widget="statinfo"
						string="Line records" class="mr4" />
				</button>
            </div>			
				<group string="Competence data">
                    <field name="comp_eval_check" invisible="1" />
                    <field name="comp_global_check" invisible="1" />
				    <field name="competence_id" 
				    attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
				    <field name="description" 
				    attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
				    <field name="eval_percent" />
                    <field name="father_competence_id" 
                    attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
                    <field name="father_father_competence_id"
                    attrs="{'invisible':['|',('comp_eval_check','=',True),('comp_global_check','=',True)],
                    'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}"/>
                    <field name="competence_type_id" 
                    attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
                </group>
                <group string="Planification data">
					<field name="planification_id" 
					attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
					<field name="teacher_id" 
					attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
					<field name="a_year_id" 
					attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
					<field name="education_center_id" 
					attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
					<field name="classroom_id" 
					attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
					<field name="task_type_id" 
					attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
					<field name="eval_type" 
					attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
					<field name="exists_master" invisible="1" />
				</group>
				<group>
					<field name='exam_ids' attrs="{'invisible': [('exists_master','=',True)]}" >
						<tree editable="bottom">
							<field name="name" />
							<field name="description" />
							<field name="eval_type" />
							<field name="exam_type_id" />
							<field name="eval_percent" />
							<field name="date" />
							<field name="mark_close_date" />
						</tree>
					</field>
					<field name='notebook_line_child_ids' attrs="{'invisible': [('exists_master','=',False)]}">
						<tree editable="bottom"
							decoration-info="comp_global_check==True"
							decoration-success="comp_eval_check==True">
                            <field name="comp_eval_check" invisible="1" />
                            <field name="comp_global_check" invisible="1" />
							<field name="competence_id" 
							attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
							<field name="description" 
							attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
							<field name="eval_percent" />
                            <field name="father_competence_id" 
                            attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
                            <field name="father_father_competence_id" 
                            attrs="{'invisible':['|',('comp_eval_check','=',True),('comp_global_check','=',True)],
                            'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}"/>
                            <field name="competence_type_id" 
                            attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
							<field name="planification_id" 
							attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
							<field name="teacher_id" 
							attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
							<field name="a_year_id" 
							attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
							<field name="education_center_id" 
							attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
							<field name="classroom_id" 
							attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
							<field name="task_type_id" 
							attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
							<field name="eval_type" 
							attrs="{'readonly':['|',('comp_eval_check','=',True),('comp_global_check','=',True)]}" />
						</tree>
					</field>
					<field name="academic_record_ids" widget="many2one_tags">
					   <tree string="Academic record" editable="bottom"
                        decoration-success="master_competence_eval_check==True"
                        decoration-info="master_competence_global_check==True">
                            <field name="exam_id" />
                            <field name="exam_type" />
                            <field name="exam_eval_percent" />
                            <field name="competence" />
                            <field name="competence_father" />
                            <field name="date" />
                            <field name="subject_id" />
                            <field name="teacher_id" />
                            <field name="kid_id" />
                            <field name="numeric_mark" />
                            <field name="n_mark_name" />
                            <field name="n_mark_reduced_name" />
                            <field name="behaviour_mark_id" />
                            <field name="master_competence_eval_check" invisible="True" />
                            <field name="master_competence_global_check" invisible="True" />
                            <field name="calculated_numeric_mark" />
                            <field name="n_mark" invisible="True" />
                            <field name="competence" invisible="True" />
                            <field name="father_record_id" invisible="True" />
                            <field name="n_line_id" invisible="True" />
                        </tree>
					</field>
				</group>
				</sheet>
			</form>
		</field>
	</record>
</odoo>

